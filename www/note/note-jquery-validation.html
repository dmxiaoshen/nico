<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <title>Jquery ValidationEngine验证插件</title>
	<link rel="shortcut icon" href="../static/img/favicon.ico">
    <link rel="stylesheet" type="text/css" media="all" href="../static/css/style.css" />
	<link rel="stylesheet" type="text/css" media="all" href="../static/css/highlight.css" />
    <link rel="stylesheet" type="text/css" media="all" href="../static/css/prettify.css" />
</head>
<body>
    <div id="primary">
        <header id="header">
    <h1 id="site-title">
        <a href="/" title="dmxiaoshen's Blog" rel="home">
            dmxiaoshen's Blog
        </a>
    </h1>
    <nav id="nav">
        <ul>
            <li>
                <a href="/note/">
                    晴耕
                </a>
            </li>
            <li>
                <a href="/article/">
                    雨读
                </a>
            </li>
        </ul>
    </nav>
</header>
        <section id="content">
<h2 class="post_title">Jquery ValidationEngine验证插件</h2>
<article>
    <h2 id="前言">前言</h2><p>在开发前台页面的时候，免不了要用到验证，js有很多验证插件，这里主要讲Jquery ValidationEngine这款插件，<br>使用简单，功能强大。<a href="http://www.position-relative.net/creation/formValidator/">jQuery.validationEngine</a></p>
<h2 id="form表单验证">form表单验证</h2><p><!--more-->
一般我们用到form标签的时候，都需要对表单进行验证，简单使用如下：  </p>
<div class="highlight"><pre><code class="javascript">&lt;form id=<span class="string">"formId"</span> action=<span class="string">"add"</span> method=<span class="string">"post"</span>&gt;
<span class="xml"><span class="tag">&lt;<span class="title">p</span>&gt;</span>
<span class="tag">&lt;<span class="title">label</span>&gt;</span>用户名:<span class="tag">&lt;/<span class="title">label</span>&gt;</span><span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"text"</span> <span class="attribute">name</span>=<span class="value">"username"</span> <span class="attribute">class</span>=<span class="value">"validate[required]"</span>  /&gt;</span>
<span class="tag">&lt;/<span class="title">p</span>&gt;</span>
<span class="tag">&lt;<span class="title">p</span>&gt;</span>
<span class="tag">&lt;<span class="title">label</span>&gt;</span>密码:<span class="tag">&lt;/<span class="title">label</span>&gt;</span><span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"password"</span> <span class="attribute">name</span>=<span class="value">"password"</span> <span class="attribute">class</span>=<span class="value">"validate[required]"</span>  /&gt;</span>
<span class="tag">&lt;/<span class="title">p</span>&gt;</span>
<span class="tag">&lt;<span class="title">p</span>&gt;</span><span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"submit"</span> <span class="attribute">value</span>=<span class="value">"新增"</span> /&gt;</span><span class="tag">&lt;/<span class="title">p</span>&gt;</span>
<span class="tag">&lt;/<span class="title">form</span>&gt;</span></span></code></pre></div><p>调用：  </p>
<div class="highlight"><pre><code class="javascript">$(<span class="string">"#formId"</span>).validationEngine();</code></pre></div><p>以上是最简单的使用方式<code>class=&quot;validate[required]&quot;</code>这个就是验证的规则，这里只是对必填项做了约束，其他一些规则文末会给出详细。  </p>
<p><strong>那么问题来了</strong>  </p>
<p>如果我要新增自己的验证规则呢，还有就是有后台ajax验证呢，比如上面新增用户这个例子，如果我有2个需求  </p>
<ol>
<li>有一个确认密码输入框，验证规则为跟密码输入框必须输入一致。</li>
<li>用户名不能重复。  </li>
</ol>
<p>这个时候框架本身没有这种规则，但是我们可以自己写，页面如下:  </p>
<div class="highlight"><pre><code class="javascript">&lt;form id=<span class="string">"formId"</span> action=<span class="string">"${ctx}/user/add"</span> method=<span class="string">"post"</span>&gt;
<span class="xml"><span class="tag">&lt;<span class="title">p</span>&gt;</span>
<span class="tag">&lt;<span class="title">label</span>&gt;</span>用户名:<span class="tag">&lt;/<span class="title">label</span>&gt;</span><span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"text"</span> <span class="attribute">name</span>=<span class="value">"username"</span> <span class="attribute">class</span>=<span class="value">"validate[required,funcCall[checkUsername]]"</span>  /&gt;</span>
<span class="tag">&lt;/<span class="title">p</span>&gt;</span>
<span class="tag">&lt;<span class="title">p</span>&gt;</span>
<span class="tag">&lt;<span class="title">label</span>&gt;</span>密码:<span class="tag">&lt;/<span class="title">label</span>&gt;</span><span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"password"</span> <span class="attribute">name</span>=<span class="value">"password"</span> <span class="attribute">class</span>=<span class="value">"validate[required]"</span>  /&gt;</span>
<span class="tag">&lt;/<span class="title">p</span>&gt;</span>
<span class="tag">&lt;<span class="title">p</span>&gt;</span>
<span class="tag">&lt;<span class="title">label</span>&gt;</span>确认密码:<span class="tag">&lt;/<span class="title">label</span>&gt;</span><span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"password"</span> <span class="attribute">name</span>=<span class="value">"password1"</span> <span class="attribute">class</span>=<span class="value">"validate[required,funcCall[checkPwd]]"</span> /&gt;</span>
<span class="tag">&lt;/<span class="title">p</span>&gt;</span>
<span class="tag">&lt;<span class="title">p</span>&gt;</span><span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"submit"</span> <span class="attribute">value</span>=<span class="value">"新增"</span> /&gt;</span><span class="tag">&lt;/<span class="title">p</span>&gt;</span>
<span class="tag">&lt;/<span class="title">form</span>&gt;</span></span></code></pre></div><p>验证的时候:  </p>
<div class="highlight"><pre><code class="javascript">$(<span class="string">"#formId"</span>).validationEngine({
    validationEventTrigger:<span class="string">""</span>,
    promptPosition:<span class="string">"centerRight"</span>,
    scroll:<span class="literal">false</span>,
    maxErrorsPerField:<span class="number">1</span>,
    customFunctions:{
        checkUsername:checkUsername,
        checkPwd:checkPwd
    },
    onValidationComplete:<span class="function"><span class="keyword">function</span><span class="params">(form,valid)</span>{</span>
        <span class="keyword">if</span>(valid){
            <span class="keyword">return</span> <span class="literal">true</span>;
        }
    }
});

<span class="function"><span class="keyword">function</span> <span class="title">checkUsername</span><span class="params">($field,rules,i,options)</span>{</span>
    <span class="keyword">var</span> userName = $field.val();

    <span class="keyword">var</span> isOk = <span class="literal">true</span>;
    $.ajax({
        url:ctx+<span class="string">"/user/checkUsername"</span>,
        type:<span class="string">"post"</span>,
        dataType:<span class="string">"json"</span>,
        async:<span class="literal">false</span>,
        data:{
            username:userName
        },success:<span class="function"><span class="keyword">function</span><span class="params">(data)</span>{</span>
            isOk = data;
        }
    });

    <span class="keyword">if</span>(!isOk){
        <span class="keyword">return</span> <span class="string">"* 用户名已经存在"</span>;
    }
}

<span class="function"><span class="keyword">function</span> <span class="title">checkPwd</span><span class="params">($field,rules,i,options)</span>{</span>
    <span class="keyword">var</span> pwd = $field.val();
    <span class="keyword">var</span> pwdPre = $(<span class="string">"input[name='password']"</span>).val();
    <span class="keyword">if</span>(pwd!=pwdPre){
        <span class="keyword">return</span> <span class="string">"* 两次输入的密码不一致"</span>;
    }
}</code></pre></div><p>后台checkUsername:  </p>
<div class="highlight"><pre><code class="java"><span class="annotation">@RequestMapping</span>(value=<span class="string">"/checkUsername"</span>)
    <span class="annotation">@ResponseBody</span>
    <span class="keyword">public</span> <span class="keyword">boolean</span> checkUsername(String username){
        User u = userService.findUserByName(username);
        <span class="keyword">return</span> u==<span class="keyword">null</span>;
    }</code></pre></div><p>对表单的验证就差不多这样了，以上应该能解决大部分的问题了。</p>
<h2 id="非表单的验证">非表单的验证</h2><p>除了用到表单，有时候还会用到ajax提交，这个时候也需要验证，比如说一些修改操作，这里以修改用户为例，<br>这时候我们不用表单，但是我们要用一个div把区域包起来，并且该div需要有一个class为<strong>validationEngineContainer</strong>。  </p>
<p>页面如下:  </p>
<div class="highlight"><pre><code class="javascript">&lt;div class=<span class="string">"validationEngineContainer"</span>&gt;
<span class="xml"><span class="tag">&lt;<span class="title">p</span>&gt;</span>
<span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"hidden"</span> <span class="attribute">value</span>=<span class="value">"${user.id}"</span> <span class="attribute">id</span>=<span class="value">"userId"</span> /&gt;</span>
<span class="tag">&lt;<span class="title">label</span>&gt;</span>用户名:<span class="tag">&lt;/<span class="title">label</span>&gt;</span><span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"text"</span> <span class="attribute">id</span>=<span class="value">"username"</span> <span class="attribute">value</span>=<span class="value">"${user.username}"</span> <span class="attribute">class</span>=<span class="value">"validate[required]"</span>  /&gt;</span>
<span class="tag">&lt;/<span class="title">p</span>&gt;</span>
<span class="tag">&lt;/<span class="title">div</span>&gt;</span>
<span class="tag">&lt;<span class="title">p</span>&gt;</span><span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"button"</span> <span class="attribute">value</span>=<span class="value">"新增"</span> <span class="attribute">id</span>=<span class="value">"update"</span>/&gt;</span><span class="tag">&lt;/<span class="title">p</span>&gt;</span></span></code></pre></div><p>调用验证如下:  </p>
<div class="highlight"><pre><code class="javascript">$(<span class="string">"#update"</span>).click(<span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
    <span class="keyword">if</span>(!$(<span class="string">".validationEngineContainer"</span>).validationEngine(<span class="string">'validate'</span>)){
        <span class="keyword">return</span>  ;
    }
    <span class="keyword">var</span> userId = $(<span class="string">"#userId"</span>).val();
    <span class="keyword">var</span> username = $(<span class="string">"#username"</span>).val();
    $.ajax({
        async:<span class="literal">false</span>,
        type:<span class="string">"post"</span>,
        url:ctx+<span class="string">"/user/update"</span>,
        dataType:<span class="string">"text"</span>,
        data:{
            id:userId,
            username:username
        },success:<span class="function"><span class="keyword">function</span><span class="params">(data)</span>{</span>
            <span class="keyword">if</span>(data==<span class="string">'success'</span>){
                alert(<span class="string">"修改成功"</span>);
            }<span class="keyword">else</span>{
                alert(<span class="string">"修改失败"</span>);
            }
        }
    });
});</code></pre></div><p><strong>如果有自定义的规则呢？</strong>  </p>
<p>页面如下:  </p>
<div class="highlight"><pre><code class="javascript">div class=<span class="string">"validationEngineContainer"</span>&gt;
<span class="xml"><span class="tag">&lt;<span class="title">p</span>&gt;</span>
<span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"hidden"</span> <span class="attribute">value</span>=<span class="value">"${user.id}"</span> <span class="attribute">id</span>=<span class="value">"userId"</span> /&gt;</span>
<span class="tag">&lt;<span class="title">label</span>&gt;</span>用户名:<span class="tag">&lt;/<span class="title">label</span>&gt;</span><span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"text"</span> <span class="attribute">id</span>=<span class="value">"username"</span> <span class="attribute">value</span>=<span class="value">"${user.username}"</span> <span class="attribute">class</span>=<span class="value">"validate[required,funcCall[checkUsername]]"</span>  /&gt;</span>
<span class="tag">&lt;/<span class="title">p</span>&gt;</span>
<span class="tag">&lt;/<span class="title">div</span>&gt;</span>
<span class="tag">&lt;<span class="title">p</span>&gt;</span><span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"button"</span> <span class="attribute">value</span>=<span class="value">"新增"</span> <span class="attribute">id</span>=<span class="value">"update"</span>/&gt;</span><span class="tag">&lt;/<span class="title">p</span>&gt;</span></span></code></pre></div><p>调用如下:  </p>
<div class="highlight"><pre><code class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">checkUsername</span><span class="params">($field,rules,i,options)</span>{</span>
    <span class="keyword">var</span> userName = $field.val();

    <span class="keyword">var</span> isOk = <span class="literal">true</span>;
    $.ajax({
        url:ctx+<span class="string">"/user/checkUsername"</span>,
        type:<span class="string">"post"</span>,
        dataType:<span class="string">"json"</span>,
        async:<span class="literal">false</span>,
        data:{
            username:userName
        },success:<span class="function"><span class="keyword">function</span><span class="params">(data)</span>{</span>
            isOk = data;
        }
    });

    <span class="keyword">if</span>(!isOk){
        <span class="keyword">return</span> <span class="string">"* 用户名已经存在"</span>;
    }
}

$(<span class="string">"#update"</span>).click(<span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
    <span class="keyword">var</span> validator = $(<span class="string">".validationEngineContainer"</span>).validationEngine({
        validationEventTrigger:<span class="string">""</span>,
        promptPosition:<span class="string">"centerRight"</span>,
        scroll:<span class="literal">false</span>,
        maxErrorsPerField:<span class="number">1</span>,
        customFunctions:{
            checkUsername:checkUsername
        }
    });

    <span class="keyword">if</span>(!validator.validationEngine(<span class="string">'validate'</span>)){
        <span class="keyword">return</span>  ;
    }
    <span class="keyword">var</span> userId = $(<span class="string">"#userId"</span>).val();
    <span class="keyword">var</span> username = $(<span class="string">"#username"</span>).val();
    $.ajax({
        async:<span class="literal">false</span>,
        type:<span class="string">"post"</span>,
        url:ctx+<span class="string">"/user/update"</span>,
        dataType:<span class="string">"text"</span>,
        data:{
            id:userId,
            username:username
        },success:<span class="function"><span class="keyword">function</span><span class="params">(data)</span>{</span>
            <span class="keyword">if</span>(data==<span class="string">'success'</span>){
                alert(<span class="string">"修改成功"</span>);
            }<span class="keyword">else</span>{
                alert(<span class="string">"修改失败"</span>);
            }
        }
    });
});</code></pre></div><h2 id="总结">总结</h2><p>至此，对于表单和非表单的验证都已经加上，并且可以自定义规则，下面补充下框架自带的一些规则。  </p>
<p><a href="http://blog.csdn.net/amohan/article/details/17528705">验证规则及API查看</a></p>

</article>
<div class="meta">
    <ul class="tags">
            <li><a href="/tag/jquery">jquery</a></li>
            <li><a href="/tag/validationEngine">validationEngine</a></li>
    </ul>
</div>
<div class="date">2014-12-09</div>
<div class="ds-thread"></div>
<script type="text/javascript">
	var duoshuoQuery = {short_name:"dmxiaoshen"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = 'http://static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
</script>
            <!-- Duoshuo Comment END -->

        </section>
    </div>
    <footer>
    © 2015-2016 dmxiaoshen's Blog | Powered by <a href="http://lab.lepture.com/nico/" target="_blank">Nico</a>
</footer>
<script defer async type="text/javascript" src="//hm.baidu.com/h.js?f10c9b0005de625e589f7dc9804b2787"></script>

    <script defer async type="text/javascript" src="../static/js/run_prettify.js"></script>
</body>
</html>