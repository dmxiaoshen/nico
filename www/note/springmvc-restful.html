<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <title>spring-mvc的restful支持</title>
	<link rel="shortcut icon" href="../static/img/favicon.ico">
    <link rel="stylesheet" type="text/css" media="all" href="../static/css/style.css" />
	<link rel="stylesheet" type="text/css" media="all" href="../static/css/highlight.css" />
    <link rel="stylesheet" type="text/css" media="all" href="../static/css/prettify.css" />
</head>
<body>
    <div id="primary">
        <header id="header">
    <h1 id="site-title">
        <a href="/" title="dmxiaoshen's Blog" rel="home">
            dmxiaoshen's Blog
        </a>
    </h1>
    <nav id="nav">
        <ul>
            <li>
                <a href="/note/">
                    晴耕
                </a>
            </li>
            <li>
                <a href="/article/">
                    雨读
                </a>
            </li>
        </ul>
    </nav>
</header>
        <section id="content">
<h2 class="post_title">spring-mvc的restful支持</h2>
<article>
    <p>需要用到:</p>
<div class="highlight"><pre><code class="xml"><span class="tag">&lt;<span class="title">dependency</span>&gt;</span>
    <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>spring-core<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">version</span>&gt;</span>${spring.version}<span class="tag">&lt;/<span class="title">version</span>&gt;</span>
<span class="tag">&lt;/<span class="title">dependency</span>&gt;</span>

<span class="tag">&lt;<span class="title">dependency</span>&gt;</span>
    <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>spring-expression<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">version</span>&gt;</span>${spring.version}<span class="tag">&lt;/<span class="title">version</span>&gt;</span>
<span class="tag">&lt;/<span class="title">dependency</span>&gt;</span>

<span class="tag">&lt;<span class="title">dependency</span>&gt;</span>
    <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>spring-beans<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">version</span>&gt;</span>${spring.version}<span class="tag">&lt;/<span class="title">version</span>&gt;</span>
<span class="tag">&lt;/<span class="title">dependency</span>&gt;</span>

<span class="tag">&lt;<span class="title">dependency</span>&gt;</span>
    <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">version</span>&gt;</span>${spring.version}<span class="tag">&lt;/<span class="title">version</span>&gt;</span>
<span class="tag">&lt;/<span class="title">dependency</span>&gt;</span>
<span class="tag">&lt;<span class="title">dependency</span>&gt;</span>
    <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>spring-context-support<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">version</span>&gt;</span>${spring.version}<span class="tag">&lt;/<span class="title">version</span>&gt;</span>
<span class="tag">&lt;/<span class="title">dependency</span>&gt;</span>
<span class="tag">&lt;<span class="title">dependency</span>&gt;</span>
    <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>spring-web<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">version</span>&gt;</span>${spring.version}<span class="tag">&lt;/<span class="title">version</span>&gt;</span>
<span class="tag">&lt;/<span class="title">dependency</span>&gt;</span>

<span class="tag">&lt;<span class="title">dependency</span>&gt;</span>
    <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">version</span>&gt;</span>${spring.version}<span class="tag">&lt;/<span class="title">version</span>&gt;</span>
<span class="tag">&lt;/<span class="title">dependency</span>&gt;</span>

<span class="tag">&lt;<span class="title">dependency</span>&gt;</span>
    <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>spring-oxm<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">version</span>&gt;</span>${spring.version}<span class="tag">&lt;/<span class="title">version</span>&gt;</span>
<span class="tag">&lt;/<span class="title">dependency</span>&gt;</span>

<span class="tag">&lt;<span class="title">dependency</span>&gt;</span>
    <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.codehaus.jackson<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>jackson-mapper-asl<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">version</span>&gt;</span>1.9.3<span class="tag">&lt;/<span class="title">version</span>&gt;</span>
<span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></code></pre></div><p>关键是spring-mvc.xml的配置:</p>
<div class="highlight"><pre><code class="xml"><span class="tag">&lt;<span class="title">bean</span> <span class="attribute">class</span>=<span class="value">"org.springframework.web.servlet.view.ContentNegotiatingViewResolver"</span>&gt;</span>
        <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"order"</span> <span class="attribute">value</span>=<span class="value">"1"</span> /&gt;</span>    
         <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"contentNegotiationManager"</span>&gt;</span>  
            <span class="tag">&lt;<span class="title">bean</span> <span class="attribute">class</span>=<span class="value">"org.springframework.web.accept.ContentNegotiationManager"</span>&gt;</span>  
                <span class="tag">&lt;<span class="title">constructor-arg</span>&gt;</span>  
                    <span class="tag">&lt;<span class="title">bean</span> <span class="attribute">class</span>=<span class="value">"org.springframework.web.accept.PathExtensionContentNegotiationStrategy"</span>&gt;</span>  
                        <span class="tag">&lt;<span class="title">constructor-arg</span>&gt;</span>  
                            <span class="tag">&lt;<span class="title">map</span>&gt;</span>  
                                <span class="tag">&lt;<span class="title">entry</span> <span class="attribute">key</span>=<span class="value">"json"</span> <span class="attribute">value</span>=<span class="value">"application/json"</span>/&gt;</span>  
                                <span class="tag">&lt;<span class="title">entry</span> <span class="attribute">key</span>=<span class="value">"xml"</span> <span class="attribute">value</span>=<span class="value">"application/xml"</span>/&gt;</span>  
                            <span class="tag">&lt;/<span class="title">map</span>&gt;</span>  
                        <span class="tag">&lt;/<span class="title">constructor-arg</span>&gt;</span>  
                    <span class="tag">&lt;/<span class="title">bean</span>&gt;</span>  
                <span class="tag">&lt;/<span class="title">constructor-arg</span>&gt;</span>  
            <span class="tag">&lt;/<span class="title">bean</span>&gt;</span>  
        <span class="tag">&lt;/<span class="title">property</span>&gt;</span>  
        <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"viewResolvers"</span>&gt;</span>
            <span class="tag">&lt;<span class="title">list</span>&gt;</span>
                <span class="tag">&lt;<span class="title">bean</span> <span class="attribute">class</span>=<span class="value">"org.springframework.web.servlet.view.BeanNameViewResolver"</span> /&gt;</span>
                <span class="tag">&lt;<span class="title">bean
</span>                    <span class="attribute">class</span>=<span class="value">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span>
                    <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"prefix"</span> <span class="attribute">value</span>=<span class="value">"/WEB-INF/views/"</span> /&gt;</span>
                    <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"suffix"</span> <span class="attribute">value</span>=<span class="value">".jsp"</span> /&gt;</span>
                <span class="tag">&lt;/<span class="title">bean</span>&gt;</span>
            <span class="tag">&lt;/<span class="title">list</span>&gt;</span>
        <span class="tag">&lt;/<span class="title">property</span>&gt;</span>
        <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"defaultViews"</span>&gt;</span>
            <span class="tag">&lt;<span class="title">list</span>&gt;</span>
                <span class="tag">&lt;<span class="title">bean</span> <span class="attribute">id</span>=<span class="value">"jsonView"</span>
                    <span class="attribute">class</span>=<span class="value">"org.springframework.web.servlet.view.json.MappingJacksonJsonView"</span> /&gt;</span>
                <span class="tag">&lt;<span class="title">bean</span> <span class="attribute">id</span>=<span class="value">"xmlView"</span>
                    <span class="attribute">class</span>=<span class="value">"org.springframework.web.servlet.view.xml.MarshallingView"</span>&gt;</span>
                    <span class="tag">&lt;<span class="title">constructor-arg</span>&gt;</span>
                        <span class="tag">&lt;<span class="title">bean</span> <span class="attribute">class</span>=<span class="value">"org.springframework.oxm.jaxb.Jaxb2Marshaller"</span>&gt;</span>
                            <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"classesToBeBound"</span>&gt;</span>
                                <span class="tag">&lt;<span class="title">list</span>&gt;</span>
                                    <span class="tag">&lt;<span class="title">value</span>&gt;</span>com.cnblogs.yjmyzz.dto.UserInfo<span class="tag">&lt;/<span class="title">value</span>&gt;</span>
                                    <span class="tag">&lt;<span class="title">value</span>&gt;</span>com.cnblogs.yjmyzz.dto.ListBean<span class="tag">&lt;/<span class="title">value</span>&gt;</span>
                                <span class="tag">&lt;/<span class="title">list</span>&gt;</span>
                            <span class="tag">&lt;/<span class="title">property</span>&gt;</span>
                        <span class="tag">&lt;/<span class="title">bean</span>&gt;</span>
                    <span class="tag">&lt;/<span class="title">constructor-arg</span>&gt;</span>
                <span class="tag">&lt;/<span class="title">bean</span>&gt;</span>
            <span class="tag">&lt;/<span class="title">list</span>&gt;</span>
        <span class="tag">&lt;/<span class="title">property</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">bean</span>&gt;</span></code></pre></div><p>controller层可以这么写:</p>
<div class="highlight"><pre><code class="cpp">  @RequestMapping(value = {<span class="string">"/user/{id}"</span>}, method = RequestMethod.GET)
  <span class="keyword">public</span> UserInfo show(@PathVariable <span class="keyword">int</span> id, HttpServletRequest request,
        HttpServletResponse response) throws Exception {
    <span class="keyword">return</span> userService.getUserInfo(id);

  }

  @RequestMapping(value = <span class="string">"/user/list"</span>, method = RequestMethod.GET)
  <span class="keyword">public</span> ListBean getAll() throws Exception {
    <span class="keyword">return</span> userService.getAllUsers();

  }

  @RequestMapping(value = {<span class="string">"/uu/{id}"</span>}, method = RequestMethod.GET)
  <span class="keyword">public</span> String uuids(@PathVariable <span class="keyword">int</span> id,ModelMap model, HttpServletRequest request,
        HttpServletResponse response) throws Exception {
    UserInfo u = userService.getUserInfo(id);
    model.put(<span class="string">"user"</span>, u);
    model.put(<span class="string">"xyz"</span>, <span class="string">"o ha yo u"</span>);
    <span class="keyword">return</span> <span class="string">"/index"</span>;
  }</code></pre></div><p>实际达到的效果是，访问/uu/1 返回相应的视图页面 访问/uu/1.json 返回json格式数据。</p>

</article>
<div class="meta">
    <ul class="tags">
            <li><a href="/tag/spring">spring</a></li>
            <li><a href="/tag/restful">restful</a></li>
    </ul>
</div>
<div class="date">2015-09-01</div>
<div class="ds-thread"></div>
<script type="text/javascript">
	var duoshuoQuery = {short_name:"dmxiaoshen"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = 'http://static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
</script>
            <!-- Duoshuo Comment END -->

        </section>
    </div>
    <footer>
    © 2015-2016 dmxiaoshen's Blog | Powered by <a href="http://lab.lepture.com/nico/" target="_blank">Nico</a>
</footer>
<script defer async type="text/javascript" src="//hm.baidu.com/h.js?f10c9b0005de625e589f7dc9804b2787"></script>

    <script defer async type="text/javascript" src="../static/js/run_prettify.js"></script>
	<script>
		var _hmt = _hmt || [];
		(function() {
		  var hm = document.createElement("script");
		  hm.src = "//hm.baidu.com/hm.js?84405cc8993d00d19f760d6fa7ec02ca";
		  var s = document.getElementsByTagName("script")[0]; 
		  s.parentNode.insertBefore(hm, s);
		})();
	</script>

</body>
</html>